# Masterskaya_2_DS45
Проект Мастерской данных 2

## Описание проекта

Интернет-магазин собирает историю покупателей, проводит рассылки предложений и
планирует будущие продажи. Для оптимизации процессов надо выделить пользователей,
которые готовы совершить покупку в ближайшее время.

## Цели исследования

Предсказать вероятность покупки в течение 90 дней

## План работы

- **Загрузка данных** - выполняется импорт необходимых библиотек, загрузка исходных данных;

- **Предобработка данных** - устраняются дубликаты, пропуски, ошибки в данных;

- **Исследовательский анализ данных** - выполняется анализ предоставленной информации - выявляются основные зависимости и распределения в данных;

- **Подготовка данных** - выполняется подготовка признаков с помощью пайплайнов;

- **Обучение моделей** - на данном этапе обучаются модели, отбирается наилучшая по метрике ROC-AUC.

## Общие вывод по проекту

В работе проведено предсказание совершения покупки в течение 90 дней среди клиентов интернет-магазина. В качестве исходных данных выступили 2 таблицы с данными о рекламных рассылках, истории покупок. Также для обучения и тестирования моделей была предоставлена таблица с целевым признаком по всем клиентам.

Анализ общей информации о каждом датафрейме показал, что во всех отсутствуют пропущенные значения. Потребовалось изменение типа данных столбцов, содержащих данные о дате и времени, а также сброс индексов в первых двух таблицах.

После выполненной предобработки данных данные из трех датафреймов `apparel_purchases`, `apparel_messages`, `apparel_target_binary` были объединены в один общий датафрейм. Размерность полученной таблицы составила 502107 на 17. В качесте ключа выступили следующие поля: `bulk_campaign_id`, `client_id`, `message_id`.

Анализ количественных и категориальных признаков в полученном датафрейме показал следующее:
- большинство покупок совершены в количестве 1 шт, однако есть исключения - максимальное количество составялет 30 шт.
- средняя цена одной покупки 1287 у.е.. При этом есть выбросы с максимальным значением в 85499 у.е.
- абсолютное большинство пользователей не совершили повторной покупки - 96 %
- в столбце `event` наиболее часто представлены значения: `click` - 34%, `purchase` - 29%, `send` - 19%, `open` - 18%. Остальные четыре уникальных значения `complain`, `unsubscribe`, `hard_bounce`, `subscribe` практически не встречаются в данных;
- наиболее популярен канал передачи данных через `email` - 73%. Через `mobile_push` передается только 27 % сообщений.

В свою очередь, построение матрицы корреляции показало, что между некоторыми признаками наблюдается сильная коллинеарность и мультиколлинеарность. Для улучшения качества данных были удалены следующие признаки: `created_at`, `message_id`, `category_2`, `category_3`.

В ходе обучения были использованы следующие модели:
- LogisticRegression
- DecisionTreeClassifier
- CatBoostClassifier

Обучение и подбор гиперпараметров выявил следующую наилучшую модель: CatBoostClassifier с `depth`=8. Значение метрики данной модели на тренировочных данных составило 0.96. На тестовых данных модель показала результат в 0.75
